"use strict";(()=>{var e={};e.id=127,e.ids=[127],e.modules={9344:e=>{e.exports=require("jsonwebtoken")},1185:e=>{e.exports=require("mongoose")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},7618:e=>{e.exports=import("bcryptjs")},1642:(e,t,n)=>{n.a(e,async(e,r)=>{try{n.r(t),n.d(t,{config:()=>l,default:()=>d,routeModule:()=>p});var a=n(1802),s=n(7153),o=n(6249),i=n(8357),u=e([i]);i=(u.then?(await u)():u)[0];let d=(0,o.l)(i,"default"),l=(0,o.l)(i,"config"),p=new a.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/tenants/[slug]/upgrade",pathname:"/api/tenants/[slug]/upgrade",bundlePath:"",filename:""},userland:i});r()}catch(e){r(e)}})},8357:(e,t,n)=>{n.a(e,async(e,r)=>{try{n.r(t),n.d(t,{default:()=>handler});var a=n(4637),s=n(8574),o=n(9823),i=e([o]);async function handler(e,t){if("POST"!==e.method)return t.status(405).end();await (0,a.connectDB)();let n=e.query.slug,r=e.headers.authorization?.split(" ")[1],i=r?(0,o.WX)(r):null;if(!i)return t.status(401).json({error:"Unauthorized"});if("Admin"!==i.role||i.tenant!==n)return t.status(403).json({error:"Forbidden"});let u=await s.Tenant.findOneAndUpdate({slug:n},{plan:"pro",$unset:{noteLimit:1}},{new:!0});if(!u)return t.status(404).json({error:"Tenant not found"});t.json({ok:!0,tenant:u})}o=(i.then?(await i)():i)[0],r()}catch(e){r(e)}})}};var t=require("../../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),n=t.X(0,[222,382,823],()=>__webpack_exec__(1642));module.exports=n})();