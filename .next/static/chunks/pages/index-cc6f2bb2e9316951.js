(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(7052)}])},7052:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Home}});var n=a(5893),o=a(7294);function Home(){let[e,t]=(0,o.useState)([]),[a,r]=(0,o.useState)(""),[l,s]=(0,o.useState)(""),[i,d]=(0,o.useState)(""),[c,u]=(0,o.useState)(""),[h,m]=(0,o.useState)(""),[f,g]=(0,o.useState)(""),[p,x]=(0,o.useState)(!1);function getAuth(){return localStorage.getItem("token")}async function loadNotes(){let e=getAuth();if(!e){window.location.href="/login";return}let a=await fetch("/api/notes",{headers:{Authorization:"Bearer ".concat(e)}});if(401===a.status){localStorage.clear(),window.location.href="/login";return}let n=await a.json();t(n)}async function createNote(e){var t;e.preventDefault();let n=getAuth(),o=await fetch("/api/notes",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({title:a,body:l})}),i=await o.json();if(403===o.status&&(null===(t=i.error)||void 0===t?void 0:t.includes("Upgrade"))){x(!0),d("Note limit reached for Free plan");return}r(""),s(""),loadNotes()}async function del(e){let t=getAuth();await fetch("/api/notes/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}}),loadNotes()}async function upgrade(){let e=getAuth(),t=localStorage.getItem("tenant"),a=await fetch("/api/tenants/".concat(t,"/upgrade"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)}});if(a.ok)d("Upgraded to Pro!"),x(!1),loadNotes();else{let e=await a.json();d(e.error||"Upgrade failed")}}return(0,o.useEffect)(()=>{u(localStorage.getItem("tenant")||""),m(localStorage.getItem("role")||""),g(localStorage.getItem("email")||""),loadNotes()},[]),(0,n.jsxs)("div",{className:"p-6 max-w-3xl mx-auto",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsxs)("h1",{className:"text-2xl font-bold",children:["Notes (",c,")"]}),(0,n.jsxs)("div",{children:[f," â€” ",h]})]}),(0,n.jsxs)("form",{onSubmit:createNote,className:"mb-4",children:[(0,n.jsx)("input",{value:a,onChange:e=>r(e.target.value),placeholder:"Title",className:"w-full p-2 mb-2 border rounded"}),(0,n.jsx)("textarea",{value:l,onChange:e=>s(e.target.value),placeholder:"Body",className:"w-full p-2 mb-2 border rounded"}),(0,n.jsx)("button",{className:"bg-green-600 text-white px-4 py-2 rounded",children:"Create Note"})]}),p&&(0,n.jsxs)("div",{className:"p-3 bg-yellow-100 border mb-4 rounded",children:[(0,n.jsxs)("div",{children:["Free plan limit reached.",(0,n.jsx)("button",{onClick:upgrade,className:"ml-2 px-3 py-1 bg-blue-600 text-white rounded",children:"Upgrade to Pro"})]}),(0,n.jsx)("div",{className:"text-sm mt-1",children:i})]}),(0,n.jsx)("div",{children:null==e?void 0:e.map(e=>(0,n.jsxs)("div",{className:"border p-3 mb-2 rounded",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("strong",{children:e.title}),(0,n.jsx)("button",{onClick:()=>del(e._id),className:"text-red-600 hover:underline",children:"Delete"})]}),(0,n.jsx)("p",{children:e.body})]},e._id))}),(0,n.jsx)("div",{className:"mt-6 text-sm text-gray-500",children:i})]})}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);